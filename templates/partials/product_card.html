<div class="product-card" onclick="window.location='{{ url_for('main.product_detail', product_id=product.id) }}'">
    <div class="product-image">
        {% if product.images and product.images[0] %}
        <img src="{{ url_for('static', filename='uploads/' + product.images[0]) }}" alt="{{ product.title }}"
            onerror="this.style.display='none'; this.nextElementSibling.style.display='flex';">
        <div class="image-fallback" style="display: none; padding: 0; overflow: hidden; width: 100%; height: 100%;">
            <svg class="category-placeholder" width="100%" height="100%" viewBox="0 0 150 150"
                preserveAspectRatio="none" data-category-id="{{ product.category.id if product.category else '' }}">
                <rect width="100%" height="100%"
                    fill="{{ product.category.color|default('#ccc') if product.category else '#ccc' }}" />
                <text x="50%" y="50%" text-anchor="middle" dy=".3em" font-family="Arial" font-size="16" fill="white"
                    font-weight="500">
                    {{ product.category.name|truncate(15) if product.category else 'No Category' }}
                </text>
            </svg>
        </div>
        {% else %}
        <div class="image-fallback" style="padding: 0; overflow: hidden; width: 100%; height: 100%;">
            <svg class="category-placeholder" width="100%" height="100%" viewBox="0 0 150 150"
                preserveAspectRatio="none" data-category-id="{{ product.category.id if product.category else '' }}">
                <rect width="100%" height="100%"
                    fill="{{ product.category.color|default('#ccc') if product.category else '#ccc' }}" />
                <text x="50%" y="50%" text-anchor="middle" dy=".3em" font-family="Arial" font-size="16" fill="white"
                    font-weight="500">
                    {{ product.category.name|truncate(15) if product.category else 'No Category' }}
                </text>
            </svg>
        </div>
        {% endif %}
    </div>
    <div class="product-info">
        <div class="product-category">{{ product.category.name if product.category else 'Без категории' }}</div>
        <h3 class="product-name">{{ product.title }}</h3>

        <div class="product-price">
            <span class="current-price">{{ product|format_product_price }}</span>
        </div>

        <div class="product-meta">
            <span>{{ product.created_at.strftime('%d.%m.%Y') }}</span>
        </div>
    </div>
</div>