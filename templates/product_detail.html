{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
    <div class="product-detail">
        <div class="product-layout">
            <!-- –ì–∞–ª–µ—Ä–µ—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π -->
            <div class="product-gallery">
                {% if product.images and product.images|length > 0 %}
                    <div class="main-image">
                        <img src="/uploads/{{ product.images[0] }}" 
                             alt="{{ product.title }}" 
                             id="mainImage">
                    </div>
                    {% if product.images|length > 1 %}
                    <div class="image-thumbnails">
                        {% for image in product.images %}
                        <img src="/uploads/{{ image }}" 
                             alt="{{ product.title }}" 
                             class="thumbnail {% if loop.first %}active{% endif %}"
                             onclick="changeImage(this)">
                        {% endfor %}
                    </div>
                    {% endif %}
                {% else %}
                    <div class="main-image no-image">
                        <div class="no-image-placeholder">
                            <i>üì∑</i>
                            <span>–ù–µ—Ç –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è</span>
                        </div>
                    </div>
                {% endif %}
            </div>
            
            <!-- –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ —Ç–æ–≤–∞—Ä–µ -->
            <div class="product-info">
                <div class="product-header">
                    <h1 class="product-title">{{ product.title }}</h1>
                    <div class="product-price">{{ "%.2f"|format(product.price) }} ‚ÇΩ</div>
                </div>
                
                <div class="product-meta">
                    <div class="meta-item">
                        <span class="meta-label">–ö–∞—Ç–µ–≥–æ—Ä–∏—è:</span>
                        <span class="meta-value">{{ product.category.name if product.category else '–ë–µ–∑ –∫–∞—Ç–µ–≥–æ—Ä–∏–∏' }}</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">–î–∞—Ç–∞ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏:</span>
                        <span class="meta-value">{{ product.created_at.strftime('%d.%m.%Y') }}</span>
                    </div>
                    <div class="meta-item">
                        <span class="meta-label">–ü—Ä–æ–¥–∞–≤–µ—Ü:</span>
                        <span class="meta-value">{{ product.user.username }}</span>
                    </div>
                </div>
                
                <div class="product-description">
                    <h3>–û–ø–∏—Å–∞–Ω–∏–µ</h3>
                    <p>{{ product.description or '–û–ø–∏—Å–∞–Ω–∏–µ –æ—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç' }}</p>
                </div>
                
                <div class="product-actions">
                    <button class="btn-primary btn-large">üìû –°–≤—è–∑–∞—Ç—å—Å—è —Å –ø—Ä–æ–¥–∞–≤—Ü–æ–º</button>
                    {% if current_user.id == product.user_id %}
                    <div class="owner-actions">
                        <a href="#" class="btn-secondary">–†–µ–¥–∞–∫—Ç–∏—Ä–æ–≤–∞—Ç—å</a>
                        <a href="#" class="btn-warning">–£–¥–∞–ª–∏—Ç—å</a>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>
    </div>
</div>

<style>
.product-detail {
    background: white;
    border-radius: 12px;
    padding: 24px;
    box-shadow: var(--shadow);
}

.product-layout {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 32px;
}

.product-gallery {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.main-image {
    width: 100%;
    height: 400px;
    border-radius: 12px;
    overflow: hidden;
    background: #f8f9fa;
    display: flex;
    align-items: center;
    justify-content: center;
}

.main-image img {
    width: 100%;
    height: 100%;
    object-fit: contain;
}

.image-thumbnails {
    display: flex;
    gap: 8px;
    flex-wrap: wrap;
}

.thumbnail {
    width: 80px;
    height: 80px;
    border-radius: 8px;
    cursor: pointer;
    border: 2px solid transparent;
    object-fit: cover;
}

.thumbnail.active,
.thumbnail:hover {
    border-color: var(--avito-blue);
}

.no-image-placeholder {
    text-align: center;
    color: var(--text-secondary);
}

.no-image-placeholder i {
    font-size: 48px;
    display: block;
    margin-bottom: 8px;
}

.product-header {
    margin-bottom: 24px;
}

.product-title {
    font-size: 24px;
    font-weight: 600;
    margin-bottom: 12px;
    color: var(--text-primary);
}

.product-price {
    font-size: 28px;
    font-weight: 700;
    color: var(--avito-blue);
}

.product-meta {
    margin-bottom: 24px;
    padding: 16px;
    background: #f8f9fa;
    border-radius: 8px;
}

.meta-item {
    display: flex;
    margin-bottom: 8px;
}

.meta-label {
    font-weight: 500;
    color: var(--text-secondary);
    min-width: 120px;
}

.meta-value {
    color: var(--text-primary);
}

.product-description h3 {
    margin-bottom: 12px;
    color: var(--text-primary);
}

.product-description p {
    line-height: 1.6;
    color: var(--text-primary);
}

.product-actions {
    margin-top: 24px;
}

.btn-large {
    padding: 16px 32px;
    font-size: 18px;
    width: 100%;
    margin-bottom: 12px;
}

.owner-actions {
    display: flex;
    gap: 12px;
}

.btn-warning {
    background: #dc3545;
    color: white;
}

.btn-warning:hover {
    background: #c82333;
}

@media (max-width: 768px) {
    .product-layout {
        grid-template-columns: 1fr;
    }
    
    .main-image {
        height: 300px;
    }
}
</style>

<script>
function changeImage(thumb) {
    const mainImage = document.getElementById('mainImage');
    if (mainImage) {
        mainImage.src = thumb.src;
    }
    
    // Update active thumbnail
    document.querySelectorAll('.thumbnail').forEach(t => t.classList.remove('active'));
    thumb.classList.add('active');
}
</script>
{% endblock %}